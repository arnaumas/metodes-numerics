\documentclass[12pt]{article}

\usepackage[catalan]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[a4paper,total={6.2in,9.3in}]{geometry}
% Formatting options
\usepackage[bf,sf]{titlesec} % Make the section titles bold and sans-serif
\usepackage[font={footnotesize,sf}]{caption} % Make captions small and sans-serif
\renewcommand{\arraystretch}{1.7}
\usepackage{amsmath,amssymb}

\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\R}{\mathbb{R}}

\newcommand{\yestag}{\refstepcounter{equation}\tag{\theequation}}

\title{\textsf{\textbf{Mètodes Numèrics \\ Pràctica 3:} Interpolació}}
\author{\textsf{Raquel Garcia, Arnau Mas}}
\date{\textsf{}}

\begin{document}
	\maketitle
	\section*{Problema 2}
	Considerem la funció de Bessel de primera espècie d'ordre zero, $J_0(x)$. Volem estimar el valor en l'absissa $x^*$ tal que $J_0(x^*)=0$, per això realitzarem interpolació inversa de graus $1$, $3$ i $5$, és a dir, si $(x, J_0(x))$ són els punts de la funció de Bessel que ens dónen, nosaltres prendrem $(J_0(x), x)$ com a punts per a realitzar la interpolació. De manera que si $p(x)$ és el nostre polinomi interpolador, al avaluar $p(0)$ obtindrem una aproximació de $x^*$.\\
	
	El programa \texttt{prob2.c} donats uns punts com a entrada, calcula el polinomi interpolador de Lagrange amb el mètode de les diferències dividides de Newton i l'avalua en el punt zero amb la regla de Horner. Els resultats que hem obtingut al realitzar les interpolacions demanades han sigut els següents:
	
	\begin{table}[h!]
		\centering
		\caption{Interpolant valors positius de $J_0(x)$ més pròxims al canvi de signe de la funció.}	
		\begin{tabular}{c|c|c}
			Grau & $x^*$ &$J_0(x^*)$\\
			\hline
			\hline
			$1$ & $2.404728613882804$  &$5.03291522479392\times10^{-5}$\\
			$3$ & $2.404822718113948$ &$1.47416266795862\times10^{-6}$\\
			$5$ & $2.404825294785460$ &$1.36489238329446\times10^{-7}$\\
		\end{tabular}
	\end{table}
	
	\begin{table}[h!]
		\centering
		\caption{Interpolant valors negatius de $J_0(x)$ més pròxims al canvi de signe de la funció.}	
		\begin{tabular}{c|c|c}
			Grau & $x^*$ &$J_0(x^*)$\\
			\hline
			\hline
			$1$ & $2.400077241947102$&$2.46750381340249\times10^{-3}$\\
			$3$ & $2.404149375353531$&$3.51087705194527\times10^{-4}$\\
			$5$ &$2.404216734868258$ &$3.16108843546827\times10^{-4}$\\
		\end{tabular}
	\end{table}
	
	\begin{table}[h!]
		\centering
		\caption{Interpolant valors de $J_0(x)$ simètrics al canvi de signe de la funció.}	
		\begin{tabular}{c|c|c}
			Grau & $x^*$ &$J_0(x^*)$\\
			\hline
			\hline
			$1$ & $2.404927513002775$  &$-5.29287203952310\times10^{-5}$\\
			$3$ & $2.404824021911155$ &$7.97298995297100\times10^{-7}$\\
			$5$ & $2.404825653043717$ &$-4.94996456864148\times10^{-8}
			$\\
		\end{tabular}
	\end{table}
	Observem que el millor resultat l'obtenim amb la interpolació de grau 5 de valors simètrics al voltant del canvi de signe de $J_0(x)$. En general les millors són les interpolacions amb els valors positius i amb els simètrics, i la interpolació amb valors negatius és prou dolenta en comparació.\\
	
	De fet ja podíem esperar des del principi que la millor interpolació fos la simètrica, ja que és l'única que en l'interval de punts interpoladors conté al $x^*$, i en general si tenim els punts interpoladors en un interval $[a,b]$ i volem avaluar el polinomi interpolador $p(x)$ en un punt fora d'aquest interval, l'error obtingut pot ser molt gran.
	
	\newpage
	\section*{Problema 3}
	El nostre objectiu és obtenir un valor aproximat de la integral
	\begin{equation}\label{valex}
		I=\int^{1}_0\dfrac{dx}{1+x^2}=\arctan(1)-\arctan(0)=\frac{1}{4}\pi\approx0.785398163397448
	\end{equation}
	pel mètode dels trapezis i pel mètode de Simpson dividint el interval $[0,1]$ en quatre parts iguals.\\
	
	El programa \texttt{prob3.c} calcula aquestes aproximacions i l'error que es comet amb cadascuna. Amb el mètode dels trapezis hem obtingut $I\approx0.782794117647059$, que comparat amb el valor exacte amb $15$ decimals de \eqref{valex} ens dóna un error aproximat de $2.604045750389\times10^{-3}$.
	
	
	Amb el mètode de Simpson obtenim $I\approx0.785392156862745$, que comparat amb $\eqref{valex}$ té un error aproximat de $6.006534703\times10^{-6}$.
	
	Per tant veiem que amb la regla composta de Simpson hem obtingut una millor aproximació.
	\newpage
	\section*{Problema 4}
	El nostre objectiu és obtenir un valor aproximat de la integral
	\begin{equation*}
	I=\int^{5}_1\dfrac{e^x}{x}dx
	\end{equation*}
	pel mètode dels trapezis dividint el interval $[1,5]$ en $n=4, 8, 16, 32, 64$ parts iguals.\\
	
	El programa \texttt{prob4.c} calcula aquestes aproximacions i una estimació de l'error comés. Els resultats obtinguts per a cada $n$ són els següents:
	\begin{table}[h!]
		\centering
		\caption{Resultat i estimació de l'error obtingut per a cada n.}	
		\begin{tabular}{c|c|c}
			$n$ & Aproximació $I$ &Estimació error\\
			\hline
			\hline
			$4$ & $40.239701356634455$  &$10.000000000000000$\\
			$8$ & $38.782928156314796$ &$2.500000000000000$\\
			$16$ & $38.413711363539406$ &$0.625000000000000$\\
			$32$ & $38.321069162332130$ &$0.156250000000000$\\
			$64$ & $38.297886904128802$ &$0.039062500000000$\\
		\end{tabular}
	\end{table}\\
	L'estimació de l'error l'hem calculat segons la fórmula:
	$$\left| \dfrac{(b-a)F}{12}h^2 \right| $$
	on $b$ i $a$ són els extrems del interval, en el nostre cas $b=5$ i $a=1$, $F$ és una fita superior de la segona derivada de la funció de la qual volem aproximar la integral al interval, i $h=(b-a)/n$. Tenim que la segona derivada de $e^x/x$ és:
	$$\dfrac{e^x(x^3-2x^2+2x)}{x^4}\leq\dfrac{e^x}{x}$$
	per a $x\geq 1$, per tant hem triat $F=e^5/5\approx30$. De manera que per a cada $n$ ens queda l'estimació de l'error següent:
	$$10\cdot\left( \frac{4}{n}\right)^2 $$
	
	Observem que per a un major nombre de divisions del interval esperem millorar l'aproximació de $I$.
	
	\newpage
	\section*{Problema 5}
	Volem calcular amb un error menor que $10^{-2}$ el valor de la integral
	$$I=\int_{1}^{2}\log(x)dx$$
	utilitzant la regla composta de Simpson.\\
	
	Una fita de l'error amb aquest mètode ve donada per:
	$$\varepsilon=\left|\dfrac{(b-a)F}{180}h^4 \right| $$
	on $b$, $a$ són els extrems del interval, $F$ és una fita superior al interval del valor absolut de la quarta derivada de la funció de la qual volem conèixer la integral, i $h=(b-a)/n$ on $n$ és el nombre de divisions del interval que utilitzem. En el nostre cas $a=1$, $b=2$, $|f^{(4)}(x)|=|-6/x^4|\leq6$ per a $x\in[1,2]$, de manera que volem:
	$$10^{-2}\geq\left| \frac{6}{180}\left( \dfrac{1}{n}\right)^4 \right| $$
	Per tant necessitarem fer com a mínim $n=2$ divisions del interval $[1,2]$ per a obtenir la precisió demanada.
	
	El programa \texttt{prob5.c} calcula aquesta integral amb diversos valors per a $n$, els resultats obtinguts són els següents:
	\begin{table}[h!]
		\centering
		\caption{Resultats per a diversos $n$ parells}	
		\begin{tabular}{c|c}
			$n$ & Aproximació $I$\\
			\hline
			\hline
			$\textbf{2}$ & $\textbf{0.385834602165434}$  \\
			$4$ & $0.386259562814567$ \\
			$6$ & $0.386287163278802$ \\
			$8$ & $0.386292043466313$ \\
		\end{tabular}
	\end{table}\\
	Observem que amb $n=2$ iteracions ja hem obtingut dues xifres decimals correctes, per tant la nostra estimació de l'error ha sigut adequada.
	
	\newpage
	\section*{Problema 6}
	En aquest problema se'ns dóna una sèrie de valors de temps i velocitat, i se'ns demana calcular l'espai recorregut. Volem doncs aproximar la integral:
	$$L=\int_{0}^{84}v(t)dt$$
	per a la qual temin valors discrets de $v(t)$ en intervals de temps de $6s$. Per tant estem dividint el interval $[0,84]$ en $n=14$ parts iguals. Per a trobar $L$ utilitzarem la regla de Simpson composta, ja que en general dóna un millor resultat que la regla composta dels trapezis. \\
	
	El programa \texttt{prob6.c} calcula aquesta aproximació. El resultat que obtenim és $L=2909.400000000000091$m, per tant la pista mesura aproximadament $2.909$km.
\end{document}
